import subprocess

def change_passwords():
    # Get a list of all users
    users_process = subprocess.Popen(['cut', '-d:', '-f1', '/etc/passwd'], stdout=subprocess.PIPE)
    output, _ = users_process.communicate()
    users = output.decode().split('\n')[:-1]

    # Iterate over each user and change their password
    for user in users:
        # Prompt for a new password
        new_password = input(f"Enter a new password for user '{user}': ")

        # Change the password using the 'passwd' command
        passwd_process = subprocess.Popen(['sudo', 'passwd', user], stdin=subprocess.PIPE, stdout=subprocess.PIPE)
        passwd_process.communicate(input=f'{new_password}\n{new_password}\n'.encode())

        # Check the exit code to determine if the password change was successful
        if passwd_process.returncode == 0:
            print(f"Password changed successfully for user '{user}'")
        else:
            print(f"Failed to change password for user '{user}'")

# Call the function to change passwords for all users
change_passwords()
